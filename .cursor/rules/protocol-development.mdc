---
description: –ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤—ã—Ö —Ñ–∏—á –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
alwaysApply: false
---
# üöÄ PROTOCOL: DEVELOPMENT

> **–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑:** `core-master.mdc` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
> **–ë–∞–∑–æ–≤—ã–µ –º–æ–¥—É–ª–∏:** `_base-confidence.mdc`, `_base-todo-usage.mdc`, `_base-challenge.mdc`, `_base-jtbd-thinking.mdc`

---

## 1. PRE-ACTION REQUIREMENTS

### 1.1. Duplicate Check (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –õ–Æ–ë–û–ì–û –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞/–∫–ª–∞—Å—Å–∞/—Ñ—É–Ω–∫—Ü–∏–∏:**

```markdown
## üîç DUPLICATE CHECK REPORT

### Target: [–ß—Ç–æ —Ö–æ—á—É —Å–æ–∑–¥–∞—Ç—å]
- Type: [file/class/function/component]
- Name: [–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ –∏–º—è]
- Purpose: [–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ]

### Search Results:
1. Semantic search: [found/not found] ‚Äî [–¥–µ—Ç–∞–ª–∏]
2. Grep search: [found/not found] ‚Äî [–¥–µ—Ç–∞–ª–∏]
3. File search: [found/not found] ‚Äî [–¥–µ—Ç–∞–ª–∏]

### Decision:
- [ ] CREATE NEW ‚Äî –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ—Ç (confidence >= 0.7)
- [ ] EXTEND EXISTING ‚Äî –Ω–∞–π–¥–µ–Ω –ø–æ—Ö–æ–∂–∏–π –≤ [path]
- [ ] ASK USER ‚Äî –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–µ–Ω–∏–µ

### Confidence: [X]%
```

### 1.2. Check existing implementations

**–ì–¥–µ –∏—Å–∫–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º:**

```
src/lib/          # utility functions
src/utils/        # helpers
src/shared/       # shared code
src/components/   # UI components
src/hooks/        # custom hooks
src/services/     # API services
src/modules/      # business logic
apps/*/           # app-specific code
```

### 1.3. JTBD Analysis (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏ Job –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

```markdown
## üéØ JTBD ANALYSIS

### Job Story:
–ö–æ–≥–¥–∞ [—Å–∏—Ç—É–∞—Ü–∏—è], —Ö–æ—á—É [–¥–µ–π—Å—Ç–≤–∏–µ], —á—Ç–æ–±—ã [–≤—ã–≥–æ–¥–∞]

### 3 –∫–ª—é—á–µ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞:
1. **–ö–∞–∫—É—é —Ä–∞–±–æ—Ç—É** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å?
   ‚Üí [–æ—Ç–≤–µ—Ç]
2. **–ß—Ç–æ –º–µ—à–∞–µ—Ç** –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç—É —Ä–∞–±–æ—Ç—É —Å–µ–π—á–∞—Å?
   ‚Üí [–æ—Ç–≤–µ—Ç]  
3. **–ö–∞–∫ –ø–æ–π–º—ë—Ç**, —á—Ç–æ —Ä–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞?
   ‚Üí [–æ—Ç–≤–µ—Ç]

### –í—ã–≥–æ–¥—ã —Ñ–∏—á–∏ (üü® –¥–æ–ª–∂–Ω—ã –ø—Ä–µ–æ–±–ª–∞–¥–∞—Ç—å):
- [–≤—ã–≥–æ–¥–∞ 1 ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
- [–≤—ã–≥–æ–¥–∞ 2]

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–ª–æ–≥–∏ (‚¨ú –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å):
- [–Ω–∞–ª–æ–≥ 1] ‚Üí –∫–∞–∫ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å: [—Å–ø–æ—Å–æ–±]
```

> **–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** `.cursor/rules/_base-jtbd-thinking.mdc`
> **–ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** `@rules_alone/ajtbd-evaluation`

---

## 2. DEVELOPMENT WORKFLOW

### Phase 1: PLAN
```markdown
## üìã DEVELOPMENT PLAN

### Task:
[–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å]

### Expected Output:
- [ ] [–ê—Ä—Ç–µ—Ñ–∞–∫—Ç 1]
- [ ] [–ê—Ä—Ç–µ—Ñ–∞–∫—Ç 2]

### Test Cases (BEFORE implementation):
| # | Input | Expected Output | Status |
|---|-------|-----------------|--------|
| 1 | [input] | [expected] | ‚è≥ |
| 2 | [edge case] | [expected] | ‚è≥ |
| 3 | [error case] | [error message] | ‚è≥ |

### Dependencies:
- [—á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏]
```

### Phase 2: EXECUTE (TDD –ø–æ–¥—Ö–æ–¥)

1. **–ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç-–∫–µ–π—Å—ã** (–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –ü–ê–î–ê–¢–¨)
2. **–ù–∞–ø–∏—Å–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥** –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã** (–¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏)
4. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### Phase 3: VERIFY

```markdown
## ‚úÖ VERIFICATION CHECKLIST

### Code Quality:
- [ ] 0 linter errors
- [ ] 0 TypeScript errors
- [ ] No console.log (–∫—Ä–æ–º–µ debug)

### Tests:
- [ ] All test cases pass
- [ ] Edge cases covered
- [ ] Error cases handled

### JTBD Verification:
- [ ] Job Story —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é
- [ ] UI —Ç–µ–∫—Å—Ç—ã –ø—Ä–æ –≤—ã–≥–æ–¥—ã (üü®), –Ω–µ –ø—Ä–æ —Ñ–∏—á–∏
- [ ] –ú–∏–Ω–∏–º—É–º —à–∞–≥–æ–≤ –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- [ ] –ù–µ—Ç –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤/–∂–∞—Ä–≥–æ–Ω–∞
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–π–º—ë—Ç –ß–¢–û –ø–æ–ª—É—á–∏—Ç

### Artifacts:
- [ ] Each file opened and verified
- [ ] Content matches expectations
```

### Phase 4: CLEAN

```
- [ ] Remove debug code
- [ ] Update imports
- [ ] Check for duplicate code
- [ ] Update {projectname}.todo.md if needed
```

---

## 3. CODE STANDARDS

### 3.1. File Organization

```typescript
// 1. Imports (grouped)
import { external } from 'external-package';
import { internal } from '@/lib/internal';
import { local } from './local';

// 2. Types/Interfaces
interface Props { ... }

// 3. Constants
const DEFAULT_VALUE = 10;

// 4. Main implementation
export function Component() { ... }

// 5. Helper functions (if needed)
function helper() { ... }
```

### 3.2. Naming Conventions

| Type | Convention | Example |
|------|------------|---------|
| Files (components) | PascalCase | `DealsTable.tsx` |
| Files (utils) | camelCase | `formatDate.ts` |
| Functions | camelCase | `calculateTotal()` |
| Components | PascalCase | `DealsTable` |
| Constants | UPPER_SNAKE | `DEFAULT_LIMIT` |
| Types/Interfaces | PascalCase | `DealData` |

### 3.3. Error Handling

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
try {
  const result = await fetchData();
  return result;
} catch (error) {
  console.error('Failed to fetch data:', error);
  throw new Error(`Data fetch failed: ${error.message}`);
}

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
try {
  const result = await fetchData();
  return result;
} catch (error) {
  // –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
}
```

### 3.4. UI Components Check (Frontend)

**–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å:**

1. **–ö–∞–∫–∏–µ variants/props –¥–æ—Å—Ç—É–ø–Ω—ã:**
   ```bash
   grep -A 20 "cva\|variants" src/components/ui/[component].tsx
   ```

2. **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:**
   ```bash
   grep -r "<ComponentName" src/
   ```

3. **–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:**
   - `Badge variant="default"` ‚Äî —á–∞—Å—Ç–æ —Ç–∞–∫–æ–≥–æ –Ω–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ
   - `Button size="xs"` ‚Äî –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ sm/md/lg
   - –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ shadcn/ui ‚Äî –ø—Ä–æ–≤–µ—Ä—å –µ–≥–æ variants –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–µ

> **WHY:** Badge —Å variant="default" –≤—ã–∑–≤–∞–ª 2 –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏, –ø–æ—Ç–µ—Ä—è ~5 –º–∏–Ω—É—Ç –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.

### 3.5. Type Consistency Check (API Integration)

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø—Ä–∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö API/–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:**

1. **–ü—Ä–æ–≤–µ—Ä—å —Ç–∏–ø—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤:**
   ```bash
   curl -s "API_URL" | python3 -c "import sys,json; d=json.load(sys.stdin); print(type(d['field']))"
   ```
   –∏–ª–∏
   ```sql
   SELECT pg_typeof(column_name) FROM table LIMIT 1;
   ```

2. **–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã PostgreSQL ‚Üí JavaScript:**
   | PostgreSQL | JSON/JavaScript | Action |
   |------------|-----------------|--------|
   | bigint | string (!) | Number(value) |
   | numeric | string | Number(value) |
   | int | number | OK |
   
3. **Map/Set —Ç—Ä–µ–±—É—é—Ç EXACT type match:**
   ```typescript
   // ‚ùå BAD: Map<number, T> —Å –∫–ª—é—á–æ–º-—Å—Ç—Ä–æ–∫–æ–π
   map.get(26698)  // –Ω–µ –Ω–∞–π–¥—ë—Ç '26698'
   
   // ‚úÖ GOOD: –ü—Ä–∏–≤–æ–¥–∏–º –∫ –µ–¥–∏–Ω–æ–º—É —Ç–∏–ø—É
   map.get(Number(key))
   ```

4. **Cross-check –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
   - –°—Ä–∞–≤–Ω–∏ typeof —Å–≤—è–∑—ã–≤–∞–µ–º—ã—Ö –ø–æ–ª–µ–π
   - –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Map.get() –Ω–∞—Ö–æ–¥–∏—Ç –∑–∞–ø–∏—Å–∏

> **WHY:** –ë–∞–≥ "0 —Å–¥–µ–ª–æ–∫" –∏–∑-–∑–∞ managerId: string '26698' vs number 26698. –ü–æ—Ç–µ—Ä—è ~10 –º–∏–Ω—É—Ç.

### 3.6. Backend Module Creation Checklist

**–ü–æ—Ä—è–¥–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è:**

```
1. module.types.ts      ‚Üê –¢–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–≠–ö–°–ü–û–†–¢–ò–†–£–Æ–¢–°–Ø!)
         ‚Üì
2. module.repository.ts ‚Üê –†–∞–±–æ—Ç–∞ —Å –ë–î (–ò–ú–ü–û–†–¢–ò–†–£–ï–¢ types)
         ‚Üì
3. module.service.ts    ‚Üê –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–ò–ú–ü–û–†–¢–ò–†–£–ï–¢ types + repository)
         ‚Üì
4. module.routes.ts     ‚Üê HTTP endpoints (–ò–ú–ü–û–†–¢–ò–†–£–ï–¢ service)
         ‚Üì
5. src/index.ts         ‚Üê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ router
```

**–ü—Ä–∞–≤–∏–ª–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:**
- –¢–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª—è–π –¢–û–õ–¨–ö–û –≤ `types.ts` –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π
- Repository –∏ Service –ù–ï —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç —Ç–∏–ø—ã
- –ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Ç–∏–ø –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ ‚Äî –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π –∏–∑ `types.ts` –Ω–∞–ø—Ä—è–º—É—é

**Cross-check –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è:**
```bash
npm run build  # –∏–ª–∏ tsc -p tsconfig.json
```

> **WHY:** –û—à–∏–±–∫–∞ —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–∏–ø–æ–≤ –≤ assortment –º–æ–¥—É–ª–µ. –ü–æ—Ç–µ—Ä—è ~5 –º–∏–Ω—É—Ç.

### 3.7. Bitrix24 UF Fields Check

**–ü–µ—Ä–µ–¥ –ø–∞—Ä—Å–∏–Ω–≥–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ–ª–µ–π (UF_CRM_*):**

1. **–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–∏–ø –ø–æ–ª—è –≤ –±–∞–∑–µ:**
   ```sql
   SELECT 
     jsonb_typeof(raw_json->'UF_CRM_XXX') as type,
     raw_json->'UF_CRM_XXX' as sample
   FROM table 
   WHERE raw_json->'UF_CRM_XXX' IS NOT NULL
   LIMIT 5;
   ```

2. **–¢–∏–ø–∏—á–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã UF-–ø–æ–ª–µ–π:**
   | typeof | –ß—Ç–æ —ç—Ç–æ | –ö–∞–∫ –ø–∞—Ä—Å–∏—Ç—å |
   |--------|---------|-------------|
   | `"string"` = `"1062"` | ID –∏–∑ —Å–ø–∏—Å–∫–∞ | –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞ —Ç–µ–∫—Å—Ç |
   | `"string"` = `"–î–∞, ..."` | –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ | –ö–∞–∫ —Ç–µ–∫—Å—Ç |
   | `"number"` | –ß–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ | –ö–∞–∫ —á–∏—Å–ª–æ |
   | `"object"` | –°–æ—Å—Ç–∞–≤–Ω–æ–µ (—Ç–µ–ª–µ—Ñ–æ–Ω, –∞–¥—Ä–µ—Å) | –ü–∞—Ä—Å–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É |

3. **–î–ª—è –ø–æ–ª–µ–π —Ç–∏–ø–∞ "–°–ø–∏—Å–æ–∫":**
   ```typescript
   // –°–æ–±–µ—Ä–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID
   const ids = await db.query(`
     SELECT DISTINCT raw_json->>'UF_CRM_XXX' as id 
     FROM table
   `);
   
   // –°–æ–∑–¥–∞–π mapping –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
   const YES_IDS = ['1062', '1064'];
   const NO_IDS = ['1068', '1070'];
   ```

> **WHY:** –ü–æ–ª–µ "–î–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∞—è —Å–¥–µ–ª–∫–∞" —Å–æ–¥–µ—Ä–∂–∞–ª–æ ID (1062), –∞ –Ω–µ —Ç–µ–∫—Å—Ç "–î–∞". –ü–æ—Ç–µ—Ä—è ~15 –º–∏–Ω—É—Ç.

### 3.8. Entry Point Flow Check

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö entry points (scheduled tasks, API endpoints, CLI commands):**

1. **–ò–∑—É—á–∏ –ü–û–õ–ù–´–ô flow —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
   ```bash
   # –ù–∞–π–¥–∏ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω—É–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   grep -r "syncMessagesByPeriod\|syncDay\|recalculate" src/
   ```

2. **–û–ø—Ä–µ–¥–µ–ª–∏ –í–°–ï —à–∞–≥–∏ –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è:**
   - –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è? (raw data)
   - –ö–∞–∫–∏–µ summary/aggregations –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è? (calculated data)
   - –ö–∞–∫–∏–µ –ª–æ–≥–∏/—Å–æ–±—ã—Ç–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è?
   - –ö–∞–∫–∏–µ –∫—ç—à–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è?

3. **–ò—Å–ø–æ–ª—å–∑—É–π –í–´–°–û–ö–û–£–†–û–í–ù–ï–í–´–ô —Å–µ—Ä–≤–∏—Å:**
   ```typescript
   // ‚ùå BAD: –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π ‚Äî —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å flow
   await syncService.syncMessagesByPeriod(start, end);
   // –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, –Ω–æ summary –ù–ï –æ–±–Ω–æ–≤–ª—ë–Ω!
   
   // ‚úÖ GOOD: –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π ‚Äî –ø–æ–ª–Ω—ã–π flow
   await dailySummaryService.syncDay(date);
   // 1. syncMessagesByPeriod
   // 2. recalculateDay ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç summary
   ```

4. **Cross-check:**
   - –ù–∞–π–¥–∏ –≥–¥–µ UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –í–°–ï –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π: –¥–∞–Ω–Ω—ã–µ –ø–æ—è–≤–∏–ª–∏—Å—å –≤–µ–∑–¥–µ –≥–¥–µ –æ–∂–∏–¥–∞–ª–æ—Å—å?

**–ü—Ä–∏–∑–Ω–∞–∫–∏ —á—Ç–æ –Ω—É–∂–µ–Ω –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å–µ—Ä–≤–∏—Å:**
- –ï—Å—Ç—å "XxxSummaryService" –∏–ª–∏ "XxxAggregationService"
- –í UI –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π flow –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

> **WHY:** Scheduled task —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ summary –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è. UI –ø–æ–∫–∞–∑—ã–≤–∞–ª "0". –ü–æ—Ç–µ—Ä—è ~20 –º–∏–Ω—É—Ç.

---

## 4. MANDATORY ACTIONS

### –ü–æ—Å–ª–µ –ö–ê–ñ–î–û–ì–û –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. **Check lints:** `read_lints` –Ω–∞ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–π —Ñ–∞–π–ª
2. **Fix errors:** 0 errors –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º
3. **Commit message:** –ø–æ–Ω—è—Ç–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ü–æ—Å–ª–µ –ó–ê–í–ï–†–®–ï–ù–ò–Ø:
1. **Apply `_base-challenge.mdc`** ‚Äî –æ–ø—Ä–æ–≤–µ—Ä–≥–Ω–∏ —Å–µ–±—è
2. **Apply `_base-crosscheck.mdc`** ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
3. **Apply `_base-confidence.mdc`** ‚Äî –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏

---

## 5. CONFIDENCE CALIBRATION

–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º—É–ª—É –∏–∑ `_base-confidence.mdc`:

```
Base: 100%
- –ö–æ–¥ –Ω–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω: -50%
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã—Ç—ã: -40%
- –ù–µ—Ç cross-check: -30%
- Edge cases –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã: -20%
```

---

## 6. REAL EXAMPLES (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ)

### Example 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –≤ —Ç–∞–±–ª–∏—Ü—É

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üü° STANDARD

**Job Story:** "–ö–æ–≥–¥–∞ –∏—â—É –∑–∞–ø–∏—Å–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥, —Ö–æ—á—É –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—ã, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ"

**JTBD Analysis:**
- –ö–∞–∫—É—é —Ä–∞–±–æ—Ç—É? ‚Üí –ù–∞–π—Ç–∏ –∑–∞–ø–∏—Å–∏ –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- –ß—Ç–æ –º–µ—à–∞–µ—Ç? ‚Üí –ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞, –ª–∏—Å—Ç–∞—é –≤—Å–µ –∑–∞–ø–∏—Å–∏
- –ö–æ–≥–¥–∞ —É—Å–ø–µ—Ö? ‚Üí –í–∏–∂—É —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∑–∞ 3 –∫–ª–∏–∫–∞

**–®–∞–≥–∏:**
1. Duplicate Check ‚Üí –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω
2. –°–æ–∑–¥–∞–ª `DateFilter.tsx` (UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
3. –û–±–Ω–æ–≤–∏–ª `TablePage.tsx` (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
4. –ü—Ä–æ–≤–µ—Ä–∏–ª linter ‚Üí 0 errors
5. Cross-check ‚Üí —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ó–∞ 45 –º–∏–Ω, 0 –æ—à–∏–±–æ–∫

---

### Example 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üü¢ SIMPLE

**–ó–∞–¥–∞—á–∞:** –ò–∑–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ —Å —Å–∏–Ω–µ–≥–æ –Ω–∞ –∑–µ–ª—ë–Ω—ã–π

**–®–∞–≥–∏:**
1. –ù–∞–π—Ç–∏ —Ñ–∞–π–ª ‚Üí `Button.tsx`
2. –ò–∑–º–µ–Ω–∏—Ç—å: `bg-blue-500` ‚Üí `bg-green-500`
3. Linter check ‚Üí 0 errors
4. Visual check ‚Üí —Ü–≤–µ—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ó–∞ 2 –º–∏–Ω, –±–µ–∑ JTBD Analysis (SIMPLE task)

---

### Example 3: –ù–æ–≤—ã–π API endpoint

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** üü° STANDARD

**Job Story:** "–ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—á—ë—Ç–∞, —Ö–æ—á—É –ø–æ–ª—É—á–∏—Ç—å –∏—Ö –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º"

**–®–∞–≥–∏:**
1. JTBD: –ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–µ–Ω –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—é?
2. Duplicate Check ‚Üí –ø–æ—Ö–æ–∂–µ–≥–æ endpoint –Ω–µ—Ç
3. –°–æ–∑–¥–∞–ª route –≤ `routes.ts`
4. –î–æ–±–∞–≤–∏–ª —Ç–∏–ø—ã –≤ `types.ts`
5. –¢–µ—Å—Ç —á–µ—Ä–µ–∑ curl ‚Üí 200 OK
6. Cross-check —á–µ—Ä–µ–∑ –∫–æ–¥ ‚Üí –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

**–û—à–∏–±–∫–∞:** –ó–∞–±—ã–ª –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ ‚Üí –∏—Å–ø—Ä–∞–≤–∏–ª –ø–æ—Å–ª–µ linter warning

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ó–∞ 30 –º–∏–Ω, 1 –æ—à–∏–±–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)

---

**–í–µ—Ä—Å–∏—è:** 2.0
**–°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:** `_base-*`, `standard-tdd.mdc`, `standard-qa.mdc`
